<!DOCTYPE html>
<html lang="cn">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Text</title>
    <!-- 导入css -->
    <link rel="icon" href="/text.png">
    <link rel="stylesheet" href="/style.css"/>
  <meta name="generator" content="Hexo 5.4.2"></head>
  <body>

  <div id="page-container">
    <span class="pai">
    <a class="kong" href="/"> 主页 </a>
    <a class="kong" href="/archives"> 分类 </a>
    <a class="kong" href="/about"> 关于 </a>
</span>

    <div id="content-wrap">
        <div class="container">
          <!-- 点击文章 -->
<div>
  <h1>爬虫 requests模块(吃牢饭集合)</h1>
  <wenzhang>
      <div class="contents">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#response-text%E5%92%8Cresponse-content%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">response.text和response.content的区别</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#response%E5%93%8D%E5%BA%94%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%85%B6%E5%AE%83%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7%E6%88%96%E6%96%B9%E6%B3%95"><span class="toc-text">response响应对象的其它常用属性或方法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#post%E6%96%B9%E6%B3%95"><span class="toc-text">post方法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#requests-session"><span class="toc-text">requests.session</span></a></li></ol>
      </div>
      <p><strong>每天一个入狱小技巧</strong></p>
<span id="more"></span>
<h1 id="response-text和response-content的区别"><a href="#response-text和response-content的区别" class="headerlink" title="response.text和response.content的区别"></a>response.text和response.content的区别</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># 导入requests库</span><br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment"># 目标url</span><br>url = <span class="hljs-string">&quot;https:www.baidu.com&quot;</span><br><br><span class="hljs-comment"># 向目标url发送get请求</span><br>response = requetst.get(url)<br><br><span class="hljs-comment"># 手动设定编码格式</span><br>response.encoding = <span class="hljs-string">&#x27;utf8&#x27;</span>  <span class="hljs-comment">#等于response.content.decode()</span><br><br><span class="hljs-comment"># 打印响应内容</span><br><span class="hljs-built_in">print</span>(response.text)  <span class="hljs-comment">#等于response.content.decode(&quot;推测出的编码字符集&quot;)</span><br></code></pre></td></tr></table></figure>

<p><strong>response.text</strong></p>
<ul>
<li>类型: str</li>
<li>解码类型: requests模块自动根据HTTP 头部对响应的编码作出有根据的推测, 推测的文本编码</li>
</ul>

<p><strong>response.content</strong></p>
<ul>
<li>类型: bytes</li>
<li>解码类型: 没有指定</li>
</ul>

<p><strong>response.content进行decode解决中文乱码</strong></p>
<ul>
<li>response.content.decode() 默认utf-8</li>
<li>response.content.decode("GBK")</li>
<ul>
<li>utf-8</li>
<li>gbk</li>
<li>gb2312</li>
<li>ascli (阿斯克码)</li>
<li>iso-8859-1</li>
</ul>
</ul>

<h1 id="response响应对象的其它常用属性或方法"><a href="#response响应对象的其它常用属性或方法" class="headerlink" title="response响应对象的其它常用属性或方法"></a>response响应对象的其它常用属性或方法</h1><p><strong>response = requests.get(url) 中response是发送请求获取的响应对象; response响应对象中·除了text, cintent获取响应内容以外还有其它常用的属性或方法</strong></p>
<ul>
<li>response.url 响应的url; 有时候响应utl和请求utl并不一致</li>
<li>response.status_code 响应状态码</li>
<li>response.requests.headers 响应对应的请求头</li>
<li>response.headers 响应头</li>
<li>response.headers._cookies 响应对应请求的cookie; 返回cookieJar类型</li>
<li>response.cookies 响应的cookie (经过set-ccookie动作; 返回cookie类型)</li>
<li>response.json() 自动将json字符串类型的响应内容转换python对象 (dict or list)</li>
</ul>

<br>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># 导入requests库</span><br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment"># 目标url</span><br>url = <span class="hljs-string">&quot;https:www.baidu.com&quot;</span><br><br><span class="hljs-comment"># 向目标url发送get请求</span><br>response = requetst.get(url)<br><br><span class="hljs-comment"># 手动设定编码格式</span><br>response.encoding = <span class="hljs-string">&#x27;utf8&#x27;</span>  <span class="hljs-comment">#等于response.content.decode()</span><br><br><span class="hljs-comment"># 打印响应内容</span><br><span class="hljs-built_in">print</span>(response.url)  <span class="hljs-comment">#打印响应的url</span><br><span class="hljs-built_in">print</span>(response.status_code)  <span class="hljs-comment">#打印响应的状态码</span><br><span class="hljs-built_in">print</span>(response.request.headers)  <span class="hljs-comment">#打印响应对象的请求头</span><br><span class="hljs-built_in">print</span>(response.headers)  <span class="hljs-comment">#打印响应头</span><br><span class="hljs-built_in">print</span>(response.request._cookies)  <span class="hljs-comment">#打印响应的url</span><br><span class="hljs-built_in">print</span>(response.cookies)  <span class="hljs-comment">#打印响应中携带的cookies</span><br></code></pre></td></tr></table></figure>


<!-- 知识点
# 掌握headers参数的使用
# 掌握发送带参数的请求
# 掌握headers中携带cookie
# 掌握cookies参数的使用
# 掌握cookieJar的转换方法
# 掌握超时参数timeout的使用
# 掌握代理ip参数proxies的使用
# 掌握使用verify参数忽略CA证书
# 掌握requests模块发送post请求
# 掌握利用requests.sesion进行状态保持 -->

<h1 id="post方法"><a href="#post方法" class="headerlink" title="post方法"></a>post方法</h1><p><strong>实现方法</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># data通常是一个字典</span><br>requests.post(uel,data)<br></code></pre></td></tr></table></figure>

<br>

<table>
<thead>
<tr>
<th>post数据来源</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>固定值</td>
<td>抓包比较不变值</td>
</tr>
<tr>
<td>输入值</td>
<td>抓包比较根据自身变化值</td>
</tr>
<tr>
<td>预设值-静态文件</td>
<td>需要提前从惊天html中获取</td>
</tr>
<tr>
<td>预设值-发请求</td>
<td>需要对指定地址发送请求获取数据</td>
</tr>
<tr>
<td>在客户端生成的</td>
<td>发现js模拟生成数据</td>
</tr>
</tbody></table>
<h1 id="requests-session"><a href="#requests-session" class="headerlink" title="requests.session"></a>requests.session</h1><p><strong>requests.session的作用</strong></p>
<ul>
<li>自动保存或者处理cookie, 下一次请求会带上前一次的cookie</li>
</ul>
<p><strong>场景</strong></p>
<ul>
<li>连续的多次请求, 自动处理过程中产生的cookie</li>
</ul>
<p><strong>使用方法 注意: sesson对象发送get或post请求参数, 与reques模块发送请求的参数完全一致</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Python">session = requests.session() <span class="hljs-comment">#实例化session对象</span><br><br>response = session.get(url, headers, ...)<br><br>response = session.post(url, data, ...)<br></code></pre></td></tr></table></figure>

<br>




      <div id="lv-container" data-id="city" data-uid="MTAyMC80NTk3NS8yMjQ4Ng==">
  <!-- 评论系统 -->
  <script type="text/javascript">
     (function(d, s) {
         var j, e = d.getElementsByTagName(s)[0];
         if (typeof LivereTower === 'function') { return; }
  
         j = d.createElement(s);
         j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
         j.async = true;
  
         e.parentNode.insertBefore(j, e);
     })(document, 'script');
  </script>


  </wenzhang>






        </div>
    </div>
    
<footer id="footer" >
    <span class="konga">
        <a class="jiao"  href="."><</a>
            <input type="text" id="text_input"  placeholder="搜索" >
            
        <a class="jiao"  href=".">></a>
    </span>
    <div id="text_output"></div>
    </div>

</footer>

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

<bokebangquan>
<!-- 博客版权 -->
<p><strong>
  作者: 我叫史迪奇
  <br>
  本文来自于: 
   <a href="https://sdq3.link/reptile-header-requests.html">https://sdq3.link/reptile-header-requests.html</a>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</strong></p>

</bokebangqua>


  </div>
  
<script src="/jquery.min.js"></script>

  
<script src="/main.js"></script>

  </body>
</html>
